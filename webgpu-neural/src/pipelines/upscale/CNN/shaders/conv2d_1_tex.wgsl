
// Layer: conv2d_1_0 - Conv2D with multiple inputs
@group(0) @binding(0) var conv2d_tex: texture_2d<f32>;
@group(0) @binding(1) var conv2d_1_tex: texture_storage_2d<rgba16float, write>;

fn max4(v: vec4f, val: f32) -> vec4f {
  return max(v, vec4f(val));
}

fn go_0(pos: vec2u, x_off: i32, y_off: i32) -> vec4f {
  return max4(textureLoad(conv2d_tex, vec2i(i32(pos.x) + x_off, i32(pos.y) + y_off), 0), 0.0);
}
fn go_1(pos: vec2u, x_off: i32, y_off: i32) -> vec4f {
  return max4(-textureLoad(conv2d_tex, vec2i(i32(pos.x) + x_off, i32(pos.y) + y_off), 0), 0.0);
}
@compute
@workgroup_size(8, 8)
fn computeMain(@builtin(global_invocation_id) pixel: vec3u) {
  let dim_out: vec2u = textureDimensions(conv2d_1_tex);
  if (pixel.x >= dim_out.x || pixel.y >= dim_out.y) {
    return;
  }
  var result: vec4f = vec4f(0.0);

  // Output channels 0 to 3

  result += mat4x4<f32>(
    -0.07955594, 0.16636209, -0.03371245, 0.02329453,
    0.03430393, -0.07649741, 0.03485677, -0.08241554,
    -0.01265135, 0.03670568, -0.00555434, 0.08696452,
    -0.04307268, -0.20846707, 0.09292784, -0.13483632
  ) * go_0(pixel.xy, -1, -1);

  result += mat4x4<f32>(
    -0.06324160, 0.22287320, 0.22504628, -0.10064945,
    0.04980920, 0.03820362, 0.25217634, 0.00709060,
    0.13612777, -0.07743672, 0.03283474, -0.02777385,
    0.18146823, -0.31674868, 0.20832293, -0.06689977
  ) * go_0(pixel.xy, -1, 0);

  result += mat4x4<f32>(
    0.10959341, -0.00579670, 0.31104094, 0.13072166,
    -0.01825304, -0.05531241, 0.03780018, 0.00810018,
    0.02273213, -0.01464052, 0.04918494, 0.08065189,
    -0.13446802, -0.05218817, -0.25689486, -0.08787424
  ) * go_0(pixel.xy, -1, 1);

  result += mat4x4<f32>(
    -0.29013368, 0.34277481, 0.04593530, 0.08519628,
    -0.23372893, 0.29263476, 0.13298857, -0.00744642,
    0.05842198, -0.17870559, 0.06660627, 0.03221104,
    0.05942984, 0.08357466, 0.03616943, -0.03071167
  ) * go_0(pixel.xy, 0, -1);

  result += mat4x4<f32>(
    0.11649150, 0.10724349, -0.22581147, -0.07556447,
    -0.01531538, 0.13391304, -0.19678695, -0.04893378,
    0.12793374, -0.09597500, 0.01799629, -0.12972197,
    -0.07576519, 0.47710335, 0.15841860, -0.34332204
  ) * go_0(pixel.xy, 0, 0);

  result += mat4x4<f32>(
    -0.18826906, -0.24958195, 0.19208565, -0.44949016,
    0.02883107, 0.04245297, -0.31702819, -0.12473460,
    -0.21731816, -0.27475184, 0.28346357, -0.07759357,
    -0.08405513, -0.20444775, 0.04848144, 0.05601133
  ) * go_0(pixel.xy, 0, 1);

  result += mat4x4<f32>(
    0.10669420, 0.07790834, -0.08228616, 0.03753407,
    -0.29281160, -0.07904179, 0.02899900, -0.10095498,
    -0.04360377, -0.09632308, 0.01944831, -0.01369981,
    0.01776052, 0.07730017, 0.05695163, 0.02185305
  ) * go_0(pixel.xy, 1, -1);

  result += mat4x4<f32>(
    -0.34980723, -0.48544812, -0.03359392, -0.17862111,
    0.42395216, 0.45183858, -0.19371353, 0.29258275,
    0.20984103, 0.26663160, -0.07286634, 0.09263772,
    -0.06540334, -0.04350070, -0.06103292, 0.00575155
  ) * go_0(pixel.xy, 1, 0);

  result += mat4x4<f32>(
    0.02935748, -0.01182522, -0.18169789, -0.06444129,
    -0.01319113, -0.12490011, 0.01823680, 0.04428167,
    -0.22992000, -0.12943985, 0.07866026, -0.10092097,
    -0.14341719, -0.01093964, 0.09860750, -0.08052277
  ) * go_0(pixel.xy, 1, 1);

  result += mat4x4<f32>(
    0.01890974, -0.13395534, 0.03582076, -0.07491405,
    0.05678631, 0.07507104, -0.04762295, 0.07424159,
    0.06612478, -0.04756584, -0.00309374, -0.02275107,
    -0.00250386, 0.17780033, -0.05391308, 0.14789844
  ) * go_0(pixel.xy, -1, -1);

  result += mat4x4<f32>(
    -0.01668151, -0.17413756, -0.15372097, 0.10195319,
    0.02872393, -0.01932337, -0.20223117, 0.05833731,
    -0.07740887, 0.09695172, -0.00954041, 0.08709247,
    -0.24971780, 0.34091350, -0.27679151, -0.09418374
  ) * go_0(pixel.xy, -1, 0);

  result += mat4x4<f32>(
    -0.17119984, 0.02867439, -0.41403720, -0.29060769,
    0.02747281, 0.05010191, 0.05084029, 0.03254511,
    -0.02807534, -0.00343104, -0.04015321, -0.07159857,
    0.16923817, 0.12372661, 0.30329165, 0.12525889
  ) * go_0(pixel.xy, -1, 1);

  result += mat4x4<f32>(
    0.11812621, -0.33777910, 0.01554100, -0.25357676,
    0.29495889, -0.14573601, -0.14926067, 0.04948696,
    -0.01215382, 0.20359826, -0.03477299, 0.04579150,
    -0.04639857, -0.13774747, 0.02099239, 0.01978973
  ) * go_0(pixel.xy, 0, -1);

  result += mat4x4<f32>(
    -0.44270262, 0.03377248, 0.19550847, -0.49989861,
    -0.05415202, -0.12982067, 0.46766430, 0.38987458,
    -0.28350073, 0.15354778, 0.05561978, 0.16454346,
    0.01846066, -0.42015374, -0.23037902, -0.04018472
  ) * go_0(pixel.xy, 0, 0);

  result += mat4x4<f32>(
    0.12044752, 0.11113761, -0.22488078, 0.33022031,
    -0.04298620, -0.02422378, 0.32801566, -0.00014307,
    0.17294300, 0.34193915, -0.32857502, 0.02653993,
    0.02739026, 0.15361080, 0.02112902, -0.08016293
  ) * go_0(pixel.xy, 0, 1);

  result += mat4x4<f32>(
    -0.15700138, -0.03814428, 0.03411710, -0.14302759,
    0.17085651, 0.05421995, 0.08283383, 0.07189512,
    0.04690460, 0.13525289, 0.03526428, 0.06021166,
    -0.06082767, -0.05446401, 0.01187251, -0.02663013
  ) * go_0(pixel.xy, 1, -1);

  result += mat4x4<f32>(
    0.19925499, 0.35248706, -0.06656671, -0.05936081,
    -0.59729880, -0.45500758, 0.04338771, -0.06707226,
    -0.17624056, -0.36543533, 0.03824874, -0.08289259,
    0.03352717, 0.06039247, 0.02937581, -0.03682428
  ) * go_0(pixel.xy, 1, 0);

  result += mat4x4<f32>(
    0.03880598, 0.05427575, 0.17549393, 0.11383997,
    -0.04976867, 0.07055373, -0.07307428, -0.16222152,
    0.21557014, 0.13381441, -0.08565409, 0.05819226,
    0.11020328, -0.01554787, -0.02202509, 0.09163206
  ) * go_0(pixel.xy, 1, 1);

  result += mat4x4<f32>(
    -0.07955594, 0.16636209, -0.03371245, 0.02329453,
    0.03430393, -0.07649741, 0.03485677, -0.08241554,
    -0.01265135, 0.03670568, -0.00555434, 0.08696452,
    -0.04307268, -0.20846707, 0.09292784, -0.13483632
  ) * go_1(pixel.xy, -1, -1);

  result += mat4x4<f32>(
    -0.06324160, 0.22287320, 0.22504628, -0.10064945,
    0.04980920, 0.03820362, 0.25217634, 0.00709060,
    0.13612777, -0.07743672, 0.03283474, -0.02777385,
    0.18146823, -0.31674868, 0.20832293, -0.06689977
  ) * go_1(pixel.xy, -1, 0);

  result += mat4x4<f32>(
    0.10959341, -0.00579670, 0.31104094, 0.13072166,
    -0.01825304, -0.05531241, 0.03780018, 0.00810018,
    0.02273213, -0.01464052, 0.04918494, 0.08065189,
    -0.13446802, -0.05218817, -0.25689486, -0.08787424
  ) * go_1(pixel.xy, -1, 1);

  result += mat4x4<f32>(
    -0.29013368, 0.34277481, 0.04593530, 0.08519628,
    -0.23372893, 0.29263476, 0.13298857, -0.00744642,
    0.05842198, -0.17870559, 0.06660627, 0.03221104,
    0.05942984, 0.08357466, 0.03616943, -0.03071167
  ) * go_1(pixel.xy, 0, -1);

  result += mat4x4<f32>(
    0.11649150, 0.10724349, -0.22581147, -0.07556447,
    -0.01531538, 0.13391304, -0.19678695, -0.04893378,
    0.12793374, -0.09597500, 0.01799629, -0.12972197,
    -0.07576519, 0.47710335, 0.15841860, -0.34332204
  ) * go_1(pixel.xy, 0, 0);

  result += mat4x4<f32>(
    -0.18826906, -0.24958195, 0.19208565, -0.44949016,
    0.02883107, 0.04245297, -0.31702819, -0.12473460,
    -0.21731816, -0.27475184, 0.28346357, -0.07759357,
    -0.08405513, -0.20444775, 0.04848144, 0.05601133
  ) * go_1(pixel.xy, 0, 1);

  result += mat4x4<f32>(
    0.10669420, 0.07790834, -0.08228616, 0.03753407,
    -0.29281160, -0.07904179, 0.02899900, -0.10095498,
    -0.04360377, -0.09632308, 0.01944831, -0.01369981,
    0.01776052, 0.07730017, 0.05695163, 0.02185305
  ) * go_1(pixel.xy, 1, -1);

  result += mat4x4<f32>(
    -0.34980723, -0.48544812, -0.03359392, -0.17862111,
    0.42395216, 0.45183858, -0.19371353, 0.29258275,
    0.20984103, 0.26663160, -0.07286634, 0.09263772,
    -0.06540334, -0.04350070, -0.06103292, 0.00575155
  ) * go_1(pixel.xy, 1, 0);

  result += mat4x4<f32>(
    0.02935748, -0.01182522, -0.18169789, -0.06444129,
    -0.01319113, -0.12490011, 0.01823680, 0.04428167,
    -0.22992000, -0.12943985, 0.07866026, -0.10092097,
    -0.14341719, -0.01093964, 0.09860750, -0.08052277
  ) * go_1(pixel.xy, 1, 1);

  result += mat4x4<f32>(
    0.01890974, -0.13395534, 0.03582076, -0.07491405,
    0.05678631, 0.07507104, -0.04762295, 0.07424159,
    0.06612478, -0.04756584, -0.00309374, -0.02275107,
    -0.00250386, 0.17780033, -0.05391308, 0.14789844
  ) * go_1(pixel.xy, -1, -1);

  result += mat4x4<f32>(
    -0.01668151, -0.17413756, -0.15372097, 0.10195319,
    0.02872393, -0.01932337, -0.20223117, 0.05833731,
    -0.07740887, 0.09695172, -0.00954041, 0.08709247,
    -0.24971780, 0.34091350, -0.27679151, -0.09418374
  ) * go_1(pixel.xy, -1, 0);

  result += mat4x4<f32>(
    -0.17119984, 0.02867439, -0.41403720, -0.29060769,
    0.02747281, 0.05010191, 0.05084029, 0.03254511,
    -0.02807534, -0.00343104, -0.04015321, -0.07159857,
    0.16923817, 0.12372661, 0.30329165, 0.12525889
  ) * go_1(pixel.xy, -1, 1);

  result += mat4x4<f32>(
    0.11812621, -0.33777910, 0.01554100, -0.25357676,
    0.29495889, -0.14573601, -0.14926067, 0.04948696,
    -0.01215382, 0.20359826, -0.03477299, 0.04579150,
    -0.04639857, -0.13774747, 0.02099239, 0.01978973
  ) * go_1(pixel.xy, 0, -1);

  result += mat4x4<f32>(
    -0.44270262, 0.03377248, 0.19550847, -0.49989861,
    -0.05415202, -0.12982067, 0.46766430, 0.38987458,
    -0.28350073, 0.15354778, 0.05561978, 0.16454346,
    0.01846066, -0.42015374, -0.23037902, -0.04018472
  ) * go_1(pixel.xy, 0, 0);

  result += mat4x4<f32>(
    0.12044752, 0.11113761, -0.22488078, 0.33022031,
    -0.04298620, -0.02422378, 0.32801566, -0.00014307,
    0.17294300, 0.34193915, -0.32857502, 0.02653993,
    0.02739026, 0.15361080, 0.02112902, -0.08016293
  ) * go_1(pixel.xy, 0, 1);

  result += mat4x4<f32>(
    -0.15700138, -0.03814428, 0.03411710, -0.14302759,
    0.17085651, 0.05421995, 0.08283383, 0.07189512,
    0.04690460, 0.13525289, 0.03526428, 0.06021166,
    -0.06082767, -0.05446401, 0.01187251, -0.02663013
  ) * go_1(pixel.xy, 1, -1);

  result += mat4x4<f32>(
    0.19925499, 0.35248706, -0.06656671, -0.05936081,
    -0.59729880, -0.45500758, 0.04338771, -0.06707226,
    -0.17624056, -0.36543533, 0.03824874, -0.08289259,
    0.03352717, 0.06039247, 0.02937581, -0.03682428
  ) * go_1(pixel.xy, 1, 0);

  result += mat4x4<f32>(
    0.03880598, 0.05427575, 0.17549393, 0.11383997,
    -0.04976867, 0.07055373, -0.07307428, -0.16222152,
    0.21557014, 0.13381441, -0.08565409, 0.05819226,
    0.11020328, -0.01554787, -0.02202509, 0.09163206
  ) * go_1(pixel.xy, 1, 1);

  result += vec4f(-0.02635701, -0.19554114, -0.02619823, 0.09673200);
  textureStore(conv2d_1_tex, pixel.xy, result);
}
