
// Layer: conv2d_2_0 - Conv2D with multiple inputs
@group(0) @binding(0) var conv2d_1_tex: texture_2d<f32>;
@group(0) @binding(1) var conv2d_2_tex: texture_storage_2d<rgba16float, write>;

fn max4(v: vec4f, val: f32) -> vec4f {
  return max(v, vec4f(val));
}

fn go_0(pos: vec2u, x_off: i32, y_off: i32) -> vec4f {
  return max4(textureLoad(conv2d_1_tex, vec2i(i32(pos.x) + x_off, i32(pos.y) + y_off), 0), 0.0);
}
fn go_1(pos: vec2u, x_off: i32, y_off: i32) -> vec4f {
  return max4(-textureLoad(conv2d_1_tex, vec2i(i32(pos.x) + x_off, i32(pos.y) + y_off), 0), 0.0);
}
@compute
@workgroup_size(8, 8)
fn computeMain(@builtin(global_invocation_id) pixel: vec3u) {
  let dim_out: vec2u = textureDimensions(conv2d_2_tex);
  if (pixel.x >= dim_out.x || pixel.y >= dim_out.y) {
    return;
  }
  var result: vec4f = vec4f(0.0);

  // Output channels 0 to 3

  result += mat4x4<f32>(
    0.01878969, -0.03267333, 0.04041597, 0.00551750,
    -0.01050542, -0.02666434, 0.00690710, -0.03008019,
    0.12490539, 0.01450288, -0.08016419, -0.08322788,
    0.01333545, 0.02299948, -0.04131948, -0.08346035
  ) * go_0(pixel.xy, -1, -1);

  result += mat4x4<f32>(
    -0.15592685, -0.11899287, 0.29877511, 0.07491709,
    -0.19494952, 0.01767058, 0.05519946, 0.09304842,
    0.09426689, 0.14357163, -0.02046249, 0.13693200,
    -0.08585475, -0.07153533, 0.14952576, -0.08717801
  ) * go_0(pixel.xy, -1, 0);

  result += mat4x4<f32>(
    0.11853725, -0.13594854, -0.15443869, 0.27610755,
    -0.04753307, 0.02846436, 0.14110461, 0.00575606,
    -0.01756972, -0.06384283, -0.19352676, 0.06270405,
    0.10296959, 0.03037509, 0.03059410, -0.11374542
  ) * go_0(pixel.xy, -1, 1);

  result += mat4x4<f32>(
    -0.08996464, 0.00955336, 0.07036500, -0.01229058,
    0.06237112, -0.04365510, 0.20099063, 0.04847028,
    0.04520011, 0.11854014, 0.01338540, -0.02681217,
    -0.07267487, -0.05119238, 0.09920441, 0.15132776
  ) * go_0(pixel.xy, 0, -1);

  result += mat4x4<f32>(
    0.03761346, -0.17224260, 0.02595492, -0.09749034,
    0.47298709, -0.22049139, 0.18449649, -0.38626668,
    -0.25847316, 0.21456397, -0.15763985, -0.21755847,
    0.31489906, 0.18143845, 0.12838717, -0.22439934
  ) * go_0(pixel.xy, 0, 0);

  result += mat4x4<f32>(
    0.23191175, -0.53784478, -0.08603051, 0.42412147,
    0.02723265, -0.25503516, -0.46346727, 0.37533942,
    -0.13513926, -0.07026598, 0.02863083, -0.10199806,
    0.15630734, 0.18705714, 0.03977156, 0.17047894
  ) * go_0(pixel.xy, 0, 1);

  result += mat4x4<f32>(
    0.02737207, -0.01101327, 0.10684490, 0.10865728,
    -0.10133595, 0.00057728, -0.01373682, 0.02564975,
    -0.07510626, 0.03065878, -0.22546552, 0.00488545,
    -0.02426312, 0.01279793, 0.05083616, -0.06805996
  ) * go_0(pixel.xy, 1, -1);

  result += mat4x4<f32>(
    0.15885110, -0.02245991, 0.19354598, 0.02301800,
    0.25311035, 0.01679929, -0.20473441, -0.10342644,
    -0.21359640, -0.26564917, -0.16850440, 0.15015513,
    -0.06193588, -0.08790883, -0.51236194, -0.02971113
  ) * go_0(pixel.xy, 1, 0);

  result += mat4x4<f32>(
    0.20195755, 0.00461784, 0.19218598, -0.04275801,
    0.06459808, -0.06734884, -0.08685954, 0.13986661,
    0.06514406, 0.06090775, 0.22825401, -0.02002175,
    0.03586218, -0.08359589, -0.21058933, 0.04996214
  ) * go_0(pixel.xy, 1, 1);

  result += mat4x4<f32>(
    0.01475474, -0.03572163, -0.01916413, 0.05471982,
    0.01508384, 0.00276490, -0.05281707, 0.02077273,
    -0.14596778, -0.02083177, 0.13912299, 0.03457761,
    -0.08663107, 0.02431645, 0.04535256, 0.00460293
  ) * go_0(pixel.xy, -1, -1);

  result += mat4x4<f32>(
    -0.15510325, 0.05582304, -0.11518301, 0.05677903,
    0.28179100, -0.06002042, -0.14816469, -0.02315192,
    -0.07961050, -0.22453088, 0.04153991, -0.12013840,
    0.09887160, 0.00898210, 0.16961397, 0.07872028
  ) * go_0(pixel.xy, -1, 0);

  result += mat4x4<f32>(
    0.12214067, 0.05390693, 0.20616707, -0.13787860,
    0.10070550, -0.06065784, -0.22527547, 0.02324271,
    0.01752419, -0.01267061, 0.04317966, -0.04394932,
    -0.09581700, -0.04526280, -0.07774740, 0.16703145
  ) * go_0(pixel.xy, -1, 1);

  result += mat4x4<f32>(
    0.02067371, -0.02522065, 0.17152254, 0.10081103,
    0.04958707, -0.00012027, -0.11070674, 0.00473066,
    -0.05860905, -0.15464106, 0.23405586, -0.10543963,
    0.26138332, -0.04435010, -0.09096871, -0.17783017
  ) * go_0(pixel.xy, 0, -1);

  result += mat4x4<f32>(
    -0.16521017, 0.32279193, 0.28218612, 0.23543432,
    -0.46063900, 0.25233167, -0.02501874, 0.34177324,
    0.10765743, -0.24336907, -0.11433394, -0.17916450,
    -0.14271629, 0.02229722, -0.19762123, 0.28995052
  ) * go_0(pixel.xy, 0, 0);

  result += mat4x4<f32>(
    0.30392694, 0.39256865, 0.21130258, -0.09816127,
    -0.05625720, 0.14536981, 0.20522302, -0.24055324,
    0.12091157, 0.03528245, -0.12698828, 0.23526567,
    0.05918178, -0.24428497, -0.12584035, -0.09098309
  ) * go_0(pixel.xy, 0, 1);

  result += mat4x4<f32>(
    0.00213347, 0.00963681, 0.04359375, -0.04082973,
    0.07739909, -0.00377295, -0.02833596, -0.08619107,
    -0.00537243, 0.04356975, 0.13981761, -0.04051655,
    0.05026328, -0.01204450, -0.05716660, 0.23514001
  ) * go_0(pixel.xy, 1, -1);

  result += mat4x4<f32>(
    -0.00795723, -0.01911960, 0.00439996, 0.09402189,
    -0.29547971, -0.02149866, 0.08859787, 0.11822887,
    0.30847070, 0.12739301, -0.06530339, -0.04148810,
    0.35112798, 0.00132760, 0.03056489, 0.11530892
  ) * go_0(pixel.xy, 1, 0);

  result += mat4x4<f32>(
    -0.27109683, 0.05634749, -0.03775143, -0.05911255,
    0.03822261, 0.04229451, 0.06394774, -0.05003212,
    -0.03134911, -0.10678833, -0.23453325, 0.06175842,
    0.10751386, -0.08459316, 0.07069406, 0.10159095
  ) * go_0(pixel.xy, 1, 1);

  result += mat4x4<f32>(
    0.01878969, -0.03267333, 0.04041597, 0.00551750,
    -0.01050542, -0.02666434, 0.00690710, -0.03008019,
    0.12490539, 0.01450288, -0.08016419, -0.08322788,
    0.01333545, 0.02299948, -0.04131948, -0.08346035
  ) * go_1(pixel.xy, -1, -1);

  result += mat4x4<f32>(
    -0.15592685, -0.11899287, 0.29877511, 0.07491709,
    -0.19494952, 0.01767058, 0.05519946, 0.09304842,
    0.09426689, 0.14357163, -0.02046249, 0.13693200,
    -0.08585475, -0.07153533, 0.14952576, -0.08717801
  ) * go_1(pixel.xy, -1, 0);

  result += mat4x4<f32>(
    0.11853725, -0.13594854, -0.15443869, 0.27610755,
    -0.04753307, 0.02846436, 0.14110461, 0.00575606,
    -0.01756972, -0.06384283, -0.19352676, 0.06270405,
    0.10296959, 0.03037509, 0.03059410, -0.11374542
  ) * go_1(pixel.xy, -1, 1);

  result += mat4x4<f32>(
    -0.08996464, 0.00955336, 0.07036500, -0.01229058,
    0.06237112, -0.04365510, 0.20099063, 0.04847028,
    0.04520011, 0.11854014, 0.01338540, -0.02681217,
    -0.07267487, -0.05119238, 0.09920441, 0.15132776
  ) * go_1(pixel.xy, 0, -1);

  result += mat4x4<f32>(
    0.03761346, -0.17224260, 0.02595492, -0.09749034,
    0.47298709, -0.22049139, 0.18449649, -0.38626668,
    -0.25847316, 0.21456397, -0.15763985, -0.21755847,
    0.31489906, 0.18143845, 0.12838717, -0.22439934
  ) * go_1(pixel.xy, 0, 0);

  result += mat4x4<f32>(
    0.23191175, -0.53784478, -0.08603051, 0.42412147,
    0.02723265, -0.25503516, -0.46346727, 0.37533942,
    -0.13513926, -0.07026598, 0.02863083, -0.10199806,
    0.15630734, 0.18705714, 0.03977156, 0.17047894
  ) * go_1(pixel.xy, 0, 1);

  result += mat4x4<f32>(
    0.02737207, -0.01101327, 0.10684490, 0.10865728,
    -0.10133595, 0.00057728, -0.01373682, 0.02564975,
    -0.07510626, 0.03065878, -0.22546552, 0.00488545,
    -0.02426312, 0.01279793, 0.05083616, -0.06805996
  ) * go_1(pixel.xy, 1, -1);

  result += mat4x4<f32>(
    0.15885110, -0.02245991, 0.19354598, 0.02301800,
    0.25311035, 0.01679929, -0.20473441, -0.10342644,
    -0.21359640, -0.26564917, -0.16850440, 0.15015513,
    -0.06193588, -0.08790883, -0.51236194, -0.02971113
  ) * go_1(pixel.xy, 1, 0);

  result += mat4x4<f32>(
    0.20195755, 0.00461784, 0.19218598, -0.04275801,
    0.06459808, -0.06734884, -0.08685954, 0.13986661,
    0.06514406, 0.06090775, 0.22825401, -0.02002175,
    0.03586218, -0.08359589, -0.21058933, 0.04996214
  ) * go_1(pixel.xy, 1, 1);

  result += mat4x4<f32>(
    0.01475474, -0.03572163, -0.01916413, 0.05471982,
    0.01508384, 0.00276490, -0.05281707, 0.02077273,
    -0.14596778, -0.02083177, 0.13912299, 0.03457761,
    -0.08663107, 0.02431645, 0.04535256, 0.00460293
  ) * go_1(pixel.xy, -1, -1);

  result += mat4x4<f32>(
    -0.15510325, 0.05582304, -0.11518301, 0.05677903,
    0.28179100, -0.06002042, -0.14816469, -0.02315192,
    -0.07961050, -0.22453088, 0.04153991, -0.12013840,
    0.09887160, 0.00898210, 0.16961397, 0.07872028
  ) * go_1(pixel.xy, -1, 0);

  result += mat4x4<f32>(
    0.12214067, 0.05390693, 0.20616707, -0.13787860,
    0.10070550, -0.06065784, -0.22527547, 0.02324271,
    0.01752419, -0.01267061, 0.04317966, -0.04394932,
    -0.09581700, -0.04526280, -0.07774740, 0.16703145
  ) * go_1(pixel.xy, -1, 1);

  result += mat4x4<f32>(
    0.02067371, -0.02522065, 0.17152254, 0.10081103,
    0.04958707, -0.00012027, -0.11070674, 0.00473066,
    -0.05860905, -0.15464106, 0.23405586, -0.10543963,
    0.26138332, -0.04435010, -0.09096871, -0.17783017
  ) * go_1(pixel.xy, 0, -1);

  result += mat4x4<f32>(
    -0.16521017, 0.32279193, 0.28218612, 0.23543432,
    -0.46063900, 0.25233167, -0.02501874, 0.34177324,
    0.10765743, -0.24336907, -0.11433394, -0.17916450,
    -0.14271629, 0.02229722, -0.19762123, 0.28995052
  ) * go_1(pixel.xy, 0, 0);

  result += mat4x4<f32>(
    0.30392694, 0.39256865, 0.21130258, -0.09816127,
    -0.05625720, 0.14536981, 0.20522302, -0.24055324,
    0.12091157, 0.03528245, -0.12698828, 0.23526567,
    0.05918178, -0.24428497, -0.12584035, -0.09098309
  ) * go_1(pixel.xy, 0, 1);

  result += mat4x4<f32>(
    0.00213347, 0.00963681, 0.04359375, -0.04082973,
    0.07739909, -0.00377295, -0.02833596, -0.08619107,
    -0.00537243, 0.04356975, 0.13981761, -0.04051655,
    0.05026328, -0.01204450, -0.05716660, 0.23514001
  ) * go_1(pixel.xy, 1, -1);

  result += mat4x4<f32>(
    -0.00795723, -0.01911960, 0.00439996, 0.09402189,
    -0.29547971, -0.02149866, 0.08859787, 0.11822887,
    0.30847070, 0.12739301, -0.06530339, -0.04148810,
    0.35112798, 0.00132760, 0.03056489, 0.11530892
  ) * go_1(pixel.xy, 1, 0);

  result += mat4x4<f32>(
    -0.27109683, 0.05634749, -0.03775143, -0.05911255,
    0.03822261, 0.04229451, 0.06394774, -0.05003212,
    -0.03134911, -0.10678833, -0.23453325, 0.06175842,
    0.10751386, -0.08459316, 0.07069406, 0.10159095
  ) * go_1(pixel.xy, 1, 1);

  result += vec4f(-0.06730856, 0.00891067, -0.08058583, 0.10518976);
  textureStore(conv2d_2_tex, pixel.xy, result);
}
